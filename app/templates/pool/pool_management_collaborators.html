{% extends "pool/pool_management.html" %}
{% block pools_settings %}

<script>
    var element = document.getElementById("management_collaborators_href");
    element.classList.remove("text-stone-800");
    element.classList.add("text-blue-600");
</script>

<script>
    function enable_add_participant() {
        var form = document.getElementById("add_participant_form");
        form.classList.remove("hidden");
        form.classList.add("flex");

        var overlay = document.getElementById("back_overlay");
        overlay.classList.remove("hidden");
        overlay.classList.add("block");
    }

    function close_add_participant() {
        var form = document.getElementById("add_participant_form");
        form.classList.remove("flex");
        form.classList.add("hidden");
        
        var overlay = document.getElementById("back_overlay");
        overlay.classList.remove("block");
        overlay.classList.add("hidden");
    }
</script>

<div id="back_overlay" class="fixed hidden top-0 left-0 w-full h-full bg-black/50 z-10 ">
    <form id="add_participant_form" class="fixed hidden top-1/4 left-1/3 w-3/12 z-0 border-2 border-sky-400 rounded-md flex-col justify-around items-center p-4 bg-white"
        action="/pool/{{ current_pool.hashed_id }}/management/collaborators" method="post">
        <button class="flex justify-end border-0 bg-transparent" onclick="close_add_participant()">
            <img src="/static/images/cancel.png" width="7%">
        </button>
        <div class="flex justify-center mb-8">
            <span class="text-lg text-stone-800">Добавить участника в <span class="font-semibold">{{ current_pool.name }}</span></span>
        </div>
        <input type="text" placeholder="Логин" id="login1" name="login1" class="p-2 w-full text-xl text-stone-800 bg-neutral-100 border border-solid border-neutral-300 rounded-md" required>
        <div class="h-px w-full bg-neutral-300 mt-4 mb-4"></div>
        <input class="w-full hover: cursor-pointer px-8 py-2 rounded-lg text-lg text-white font-semibold bg-blue-400 hover:bg-blue-500 active:bg-blue-600" type="submit" value="Добавить">
        <script>
            autocomplete(document.getElementById("login1"), {"obj": "users"});
        </script>
    </form>
</div>

<section>
    <h1 class="text-2xl text-stone-800 font-medium">Количество участников</h1>
    <div class="h-px w-full bg-neutral-300 mt-2 mb-4"></div>
    <ul class="text-lg">
        <li><span class="inline-block text-blue-500 mr-2 font-semibold w-60">Всего пользователей:</span>{{ current_pool.get_users()|length }} чел.</li>
        <li><span class="inline-block text-amber-500 mr-2 font-semibold w-60">Владельцы:</span>{{ current_pool.count_owners() }} чел.</li>
        <li><span class="inline-block text-purple-500 mr-2 font-semibold w-60">Участники:</span>{{ current_pool.count_participants() }} чел.</li>
        <li><span class="inline-block text-teal-500 mr-2 font-semibold w-60">Приглашённые:</span>{{ current_pool.count_invited() }} чел.</li>
    </ul>
</section>

<section>
    <h1 class="text-2xl text-stone-800 font-medium">Управление доступом</h1>
    <div class="h-px w-full bg-neutral-300 mt-2 mb-4"></div>
    <button class="mb-4 hover: cursor-pointer px-8 py-2 rounded-md text-lg text-white font-semibold bg-blue-400 hover:bg-blue-500 active:bg-blue-600"
            onclick="enable_add_participant()">Добавить участника!</button>

    {% include "pool/table_of_collaborators.html" %}
</section>
{% endblock %}